<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Redis | 池慕睡不着</title><meta name="keywords" content="池慕睡不着"><meta name="author" content="池慕睡不着"><meta name="copyright" content="池慕睡不着"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Redis"><meta name="application-name" content="Redis"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Redis"><meta property="og:url" content="http://example.com/2024/07/09/Redis/index.html"><meta property="og:site_name" content="池慕睡不着"><meta property="og:description" content="简介Redis的场景：数据库DB、缓存Cache、消息队列MQ 产生原因：  Mysql的技术瓶颈：磁盘IO，速度慢 Redis：支持从内存读取数据  Redis支持的数据结构  字符串String 列表Lsit 集合Set 有序集合SortedSet 哈希Hash 消息队列Stream 地理空间G"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://s2.loli.net/2024/10/14/DhY7V3iNnEbfuSL.png"><meta property="article:author" content="池慕睡不着"><meta property="article:tag" content="池慕睡不着"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://s2.loli.net/2024/10/14/DhY7V3iNnEbfuSL.png"><meta name="description" content="简介Redis的场景：数据库DB、缓存Cache、消息队列MQ 产生原因：  Mysql的技术瓶颈：磁盘IO，速度慢 Redis：支持从内存读取数据  Redis支持的数据结构  字符串String 列表Lsit 集合Set 有序集合SortedSet 哈希Hash 消息队列Stream 地理空间G"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2024/07/09/Redis/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"不要走！再看看嘛！","backTitle":"欢迎回来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: {"mode":"api","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 池慕睡不着","link":"链接: ","source":"来源: 池慕睡不着","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '池慕睡不着',
  title: 'Redis',
  postAI: '',
  pageFillDescription: '简介, Redis 为什么这么快？, 1. Redis 基于内存, 2. 基于Reactor模式的事件处理模型, 3. 多种优化过后的数据类型x2F结构, 4. 简单且高效的通信协议, 小结, Redis 除了做缓存还能做什么？, 事务, Redis 线程模型（重要）, Redis 单线程模型了解吗？, 持久化, 主从复制, 概念, 作用, 哨兵模式, 概述, 1.1、为什么要启动哨兵模式, 1.2、什么是哨兵模式, 1.3、哨兵工作原理, 1.4、哨兵功能, 常用命令, 服务器相关命令, key相关命令, 常用命令：, 五大数据类型, String(字符串), List(列表), Set(集合）, Hash（哈希）简介的场景数据库缓存消息队列产生原因的技术瓶颈磁盘速度慢支持从内存读取数据支持的数据结构字符串列表集合有序集合哈希消息队列地理空间位图位域使用方式命令行图形化界面的优势性能高数据类型丰富单键值对最大支持大小的数据简单易用支持所有主流编程语言支持数据持久化主从复制哨兵模式等高可用特性为什么这么快内部做了非常多的性能优化比较重要的有下面点基于内存内存的访问速度比磁盘快很多基于模式设计开发了一套高效的事件处理模型主要是单线程事件循环和多路复用线程模式后面会详细介绍到内置了多种优化过后的数据类型结构实现性能非常高通信协议实现简单且解析高效基于内存内存存储的优势内存的访问速度比硬盘快几个数量级通过将数据存储在内存中能够提供极低的延迟和高吞吐量适合对性能有严格要求的应用如实时分析和推荐系统内存的特性使得能够处理高负载场景但请注意内存有限数据持久化机制也是设计的重要考虑基于模式的事件处理模型模式的设计采用了单线程的事件循环模型这意味着所有的请求都在一个线程中处理从而避免了多线程带来的复杂性和上下文切换的开销多路复用如和使得可以高效地处理多个客户端的并发连接通过一个事件循环能够在单个线程内高效管理输入和输出操作减少了在多数情况下的资源消耗单线程优越性单线程可以简化代码逻辑避免由于锁争用导致的性能瓶颈通过高效的事件驱动机制能支持大量并发连接而不会出现典型多线程程序的性能问题多种优化过后的数据类型结构内置数据类型支持多种数据结构如字符串哈希列表集合有序集合等每种数据结构都经过优化能够高效地执行常见操作例如哈希结构非常适合于存储对象集合和有序集合提供了快速的去重和排序功能性能优化的目的通过专门优化的数据结构能够针对特定场景得到更快的响应时间和更高的数据处理能力极大提高了整体的系统性能简单且高效的通信协议通信协议使用了一种简单的文本协议称为该协议使得客户端可以轻松地与服务器交互并且解析效率很高高效性的效果简单的协议格式降低了理解和实现的复杂度同时也使得网络数据序列化与反序列化的速度提高这意味着客户端和服务器之间的通信延迟很低有助于提高整体响应速度小结的设计充分考虑了高性能和高并发需求结合内存存储事件驱动模型优化的数据结构及高效的通信协议使其成为现代高性能应用程序的理想选择同时开发者在使用时也需注意数据持久化和内存管理以确保数据的安全性和持久性除了做缓存还能做什么分布式锁通过来做分布式锁是一种比较常见的方式通常情况下我们都是基于来实现分布式锁关于实现分布式锁的详细介绍可以看我写的这篇文章分布式锁详解限流一般是通过脚本的方式来实现限流如果不想自己写脚本的话也可以直接利用中的来实现分布式限流其底层实现就是基于代码令牌桶算法消息队列自带的数据结构可以作为一个简单的队列使用中增加的类型的数据结构更加适合用来做消息队列它比较类似于有主题和消费组的概念支持消息持久化以及机制延时队列内置了延时队列基于实现的分布式利用或者数据类型保存数据所有的服务器都可以访问复杂业务场景通过以及扩展比如提供的数据结构我们可以很方便地完成很多复杂的业务场景比如通过统计活跃用户通过维护排行榜事务支持事务即在一次请求中执行多个命令步骤如下开启一个事务将多个命令放入一个队列入队到事务中最后由命令触发事务一并执行事务中的所有命令取消事务关系型数据库的事务一般是原子性操作要么全部成功要么全部失败单个命令的执行是原子性的但没有在事务上增加任何维持原子性的机制所以事务的执行并不是原子性的不能保证事务中的命令全部执行成功但是可以提供一下三个重要的保证批量操作在发送命令前被放入队列缓存收到命令后进入事务执行事务中任意命令执行失败其余的命令依然被执行在事务执行过程其他客户端提交的命令请求不会插入到事务执行命令序列中一个事务从开始到执行会经历以下三个阶段开始事务命令入队执行事务线程模型重要对于读写命令来说一直是单线程模型不过在版本之后引入了多线程来执行一些大键值对的异步删除操作版本之后引入了多线程来处理网络请求提高网络读写性能单线程模型了解吗持久化的数据全部在内存中如果突然宕机数据就会全部丢失未保证的数据在发生突发状况时不会丢失或者只丢失少量必须根据一些策略来把内存中的数据写到磁盘中这样当服务重启时就会将硬盘中的数据恢复到内存中持久化的意义就是为了保证突然宕机内存数据不会全部丢失详细专题万字长文详解持久化原理码路印记思否主从复制概念主从复制是指将一台服务器的数据复制到其他的服务器前者称为主节点后者称为从节点数据的复制是单向的只能从主节点复制到父节点以写为主以读为主默认情况下每台服务器都是主节点且一个主节点能有多个从节点但一个从节点只能有一个主节点作用读写分离主节点写从节点读提高服务器的读写负载能力数据冗余主从复制实现了数据的热备份是持久化之外的一种数据冗余方式故障恢复当主节点出现问题时可以由从节点提供服务实现快速的故障恢复实际上是一种服务的冗余负载均衡在主从复制的基础上配合读写分离可以由主节点提供写服务由从节点提供读服务即写数据时应用连接主节点读数据时应用连接从节点分担服务器负载尤其是在写少读多的场景下通过多个从节点分担读负载可以大大提高服务器的并发量高可用集群基石除了上述作用以外主从复制还是哨兵和集群能够实施的基础因此说主从复制是高可用的基础详情主从复制工作流程详解主从复制过程博客哨兵模式哨兵是一个分布式系统你可以在一个架构中运行多个哨兵进程这些进程使用流言协议来接收关于主服务器是否下线的信息并使用投票协议来决定是否执行自动故障迁移以及选择哪个作为新的概述为什么要启动哨兵模式当我们的主服务器宕机后手动切换主从模式的这种人工干预费事费力并且会造成我们的服务一段时间不可用所以我们通过哨兵模式来解决这个问题什么是哨兵模式哨兵模式是对系统运行情况的监控它是一个独立的进程功能有二个监控主机和从机是否正常运行主机故障后主动将从机转换为主机哨兵工作原理单个哨兵的工作原理单个哨兵只需要监控主就可能得到从多个哨兵的工作原理多个哨兵不仅同时监控主从而且哨兵之间互为监控多个哨兵防止哨兵单点故障哨兵功能集群监控负责监控主从集群中的和进程是否正常工作故障转移如果宕机会自动从中选举出新的进行主从自动切换配置中心如果发生了故障转移负责通知客户端新的的地址消息通知如果某个节点有故障那么会发送报警消息给系统管理员常用命令服务器相关命令检测连接是否存活在命令行打印一些内容退出客户端退出服务器端返回相关信息实时传递接收的请求显示慢查询切换到数据库默认有个数据库默认使用的第个查看当前数据库大小不同数据库之间数据是不能互通的移动键到指定数据库清空当前数据库中的键值对清空所有数据库的键值对相关命令在中无论什么数据类型在数据库中都是以形式保存通过进行对的操作来完成对数据库中数据的操作常用命令查看当前数据库中所有的键总数检查键是否存在删除键键过期获取键的有效时长移除键的过期时间键的数据结构类型随机返回数据库中一个键重命名当不存在时重命名代码示例五大数据类型是一个开源许可内存存储的数据结构服务器可用作数据库高速缓存和消息队列代理其通过提供多种键值数据类型来适应不同场景下的存储需求目前为止支持的键值数据类型如下字符串类型哈希类型列表类型集合类型有序集合类型字符串字符串类型是最基础的数据结构其它的几种数据结构都是在字符串类型基础上构建的字符串的值可以是字符串数字二进制但其值最大不能超过使用场景缓存计数器对象存储缓存共享限速常用命令设置一个的值仅当不存在时进行键值对并设置过期时间设置多个批量设置键值对仅当参数中所有的都不存在时执行原子性操作一起成功一起失败返回的批量获取多个保存的值查询一个是否存在将指定的数值进行仅对于数字按指定的步长对数值进行加减为数值加上浮点型数值向指定的的后追加字符串返回的类型的长度设置一个的并获取设置前的值如果不存在则返回设置指定位置的字符获取存储在上的值的一个子字符串代码示例列表列表是简单的字符串列表按照插入顺序排序你可以添加一个元素到列表的头部左边或者尾部右边也可以获取指定范围指定下标的元素等一个列表最多可以包含个元素每个列表超过亿个元素两个特点列表中的元素是有序的可以通过索引下标获取某个元素霍某个某个范围内的元素列表列表中的元素可以是重复的使用场景消息队列栈文章列表等常用指令添加操作从左边右边向列表中值一个或者多个向已存在的列名中值一个或者多个不存在失败在指定列表元素的前后插入查找操作通过索引获取列表元素获取起止元素索引从左往右递增查看列表长度删除操作从最左边最右边移除值并返回从头部开始搜索然后删除指定的至多删除个从尾部开始搜索删除列表中所有的指定通过下标截取指定范围内的列表将列表的尾部右最后一个值弹出并返回然后加到另一个列表的头部修改操作通过索引为元素设值阻塞操作移出并获取列表的第一个最后一个元素如果列表没有元素会阻塞列表直到等待超时或发现可弹出元素为止和功能相同如果列表没有元素会阻塞列表直到等待超时或发现可弹出元素为止代码示例集合的是类型的无序集合我们不能通过索引获取元素集合成员是唯一的这就意味着集合中不能出现重复的数据中集合是通过哈希表实现的所以添加删除查找的复杂度都是集合中最大的成员数为每个集合可存储多亿个成员应用场景标签常用命令集合内操作向集合中无序增加一个多个成员移除集合中一个多个成员获取集合的成员数返回集合中所有的成员查询元素是否是集合的成员若存在返回不存在返回随机返回集合中个成员缺省值为随机移除并返回集合中个成员缺省值为集合间操作返回所有集合的交集在的基础上存储结果到集合中覆盖返回所有集合的并集在的基础上存储结果到及和张覆盖返回所有集合的差集在的基础上将结果保存到集合中覆盖将集合的成员移动到集合在大量数据环境下使用此命令遍历集合中元素每次遍历部分代码示例哈希几乎所有的编程语言都提供了哈希结构中是一个类型的和的映射表',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-01-15 23:51:28',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/img/xi.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://ch-en-x.github.io" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" href="/null" title="图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="图床"/><span class="back-menu-item-text">图床</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">池慕睡不着</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/HTTP/" style="font-size: 1.05rem;">HTTP<sup>1</sup></a><a href="/tags/Java%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/" style="font-size: 1.05rem;">Java开发规范<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 1.05rem;">MySQL<sup>2</sup></a><a href="/tags/Spring/" style="font-size: 1.05rem;">Spring<sup>5</sup></a><a href="/tags/docker/" style="font-size: 1.05rem;">docker<sup>2</sup></a><a href="/tags/java%E5%9F%BA%E7%A1%80/" style="font-size: 1.05rem;">java基础<sup>1</sup></a><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 1.05rem;">设计模式<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">四月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">九月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">四月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="article-meta tags"></span></div></div><h1 class="post-title" itemprop="name headline">Redis</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-07-09T14:56:49.000Z" title="发表于 2024-07-09 22:56:49">2024-07-09</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-01-15T15:51:28.948Z" title="更新于 2025-01-15 23:51:28">2025-01-15</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="Redis"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为郴州"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>郴州</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://s2.loli.net/2024/10/14/DhY7V3iNnEbfuSL.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2024/07/09/Redis/"><header><h1 id="CrawlerTitle" itemprop="name headline">Redis</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">池慕睡不着</span><time itemprop="dateCreated datePublished" datetime="2024-07-09T14:56:49.000Z" title="发表于 2024-07-09 22:56:49">2024-07-09</time><time itemprop="dateCreated datePublished" datetime="2025-01-15T15:51:28.948Z" title="更新于 2025-01-15 23:51:28">2025-01-15</time></header><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><strong>Redis的场景：</strong>数据库DB、缓存Cache、消息队列MQ</p>
<p><strong>产生原因：</strong></p>
<ul>
<li>Mysql的技术瓶颈：磁盘IO，速度慢</li>
<li>Redis：支持从内存读取数据</li>
</ul>
<p><strong>Redis支持的数据结构</strong></p>
<ul>
<li>字符串String</li>
<li>列表Lsit</li>
<li>集合Set</li>
<li>有序集合SortedSet</li>
<li>哈希Hash</li>
<li>消息队列Stream</li>
<li>地理空间Geospatial</li>
<li>HyperLogLog</li>
<li>位图Bitmap</li>
<li>位域Bitfield</li>
</ul>
<p><strong>使用方式</strong>（命令行、API、图形化界面）</p>
<ul>
<li>CLI（Command Line Interface）</li>
<li>API（Application Programming Interface）</li>
<li>GUI（Graphical User Interface）</li>
</ul>
<p><strong>Redis的优势</strong></p>
<ul>
<li>性能高</li>
<li>数据类型丰富，单键值对最大支持512MB大小的数据</li>
<li>简单易用，支持所有主流编程语言</li>
<li>支持数据持久化、主从复制、哨兵模式等高可用特性</li>
</ul>
<h3 id="Redis-为什么这么快？"><a href="#Redis-为什么这么快？" class="headerlink" title="Redis 为什么这么快？"></a>Redis 为什么这么快？</h3><p>Redis 内部做了非常多的性能优化，比较重要的有下面 3 点：</p>
<ol>
<li>Redis 基于内存，内存的访问速度比磁盘快很多；</li>
<li>Redis 基于 Reactor 模式设计开发了一套高效的事件处理模型，主要是单线程事件循环和 IO 多路复用（Redis 线程模式后面会详细介绍到）；</li>
<li>Redis 内置了多种优化过后的数据类型&#x2F;结构实现，性能非常高。</li>
<li>Redis 通信协议实现简单且解析高效。</li>
</ol>
<h4 id="1-Redis-基于内存"><a href="#1-Redis-基于内存" class="headerlink" title="1. Redis 基于内存"></a>1. Redis 基于内存</h4><p><strong>内存存储的优势</strong>：</p>
<ul>
<li>内存的访问速度比硬盘快几个数量级。通过将数据存储在内存中，Redis 能够提供极低的延迟和高吞吐量，适合对性能有严格要求的应用，如实时分析和推荐系统。</li>
<li>内存的特性使得Redis 能够处理高负载场景，但请注意，内存有限，数据持久化机制也是Redis设计的重要考虑。</li>
</ul>
<h4 id="2-基于Reactor模式的事件处理模型"><a href="#2-基于Reactor模式的事件处理模型" class="headerlink" title="2. 基于Reactor模式的事件处理模型"></a>2. 基于Reactor模式的事件处理模型</h4><p><strong>Reactor模式的设计</strong>：</p>
<ul>
<li>Redis采用了单线程的事件循环模型，这意味着所有的请求都在一个线程中处理，从而避免了多线程带来的复杂性和上下文切换的开销。</li>
<li>IO多路复用（如 <code>epoll</code> 和 <code>select</code>）使得Redis可以高效地处理多个客户端的并发连接。通过一个事件循环，Redis能够在单个线程内高效管理输入和输出操作，减少了在多数情况下的资源消耗。</li>
</ul>
<p><strong>单线程优越性</strong>：</p>
<ul>
<li>单线程可以简化代码逻辑，避免由于锁争用导致的性能瓶颈。</li>
<li>Redis通过高效的事件驱动机制，能支持大量并发连接而不会出现典型多线程程序的性能问题。</li>
</ul>
<h4 id="3-多种优化过后的数据类型-结构"><a href="#3-多种优化过后的数据类型-结构" class="headerlink" title="3. 多种优化过后的数据类型&#x2F;结构"></a>3. 多种优化过后的数据类型&#x2F;结构</h4><p><strong>内置数据类型</strong>：</p>
<ul>
<li>Redis支持多种数据结构，如字符串、哈希、列表、集合、有序集合等。每种数据结构都经过优化，能够高效地执行常见操作。</li>
<li>例如，哈希结构非常适合于存储对象，集合和有序集合提供了快速的去重和排序功能。</li>
</ul>
<p><strong>性能优化的目的</strong>：</p>
<ul>
<li>通过专门优化的数据结构，Redis能够针对特定场景，得到更快的响应时间和更高的数据处理能力，极大提高了整体的系统性能。</li>
</ul>
<h4 id="4-简单且高效的通信协议"><a href="#4-简单且高效的通信协议" class="headerlink" title="4. 简单且高效的通信协议"></a>4. 简单且高效的通信协议</h4><p><strong>通信协议</strong>：</p>
<ul>
<li>Redis使用了一种简单的文本协议，称为RE-dis Serialization Protocol（RESP）。该协议使得客户端可以轻松地与服务器交互，并且解析效率很高。</li>
</ul>
<p><strong>高效性的效果</strong>：</p>
<ul>
<li>简单的协议格式降低了理解和实现的复杂度，同时也使得网络数据序列化与反序列化的速度提高。这意味着客户端和服务器之间的通信延迟很低，有助于提高整体响应速度。</li>
</ul>
<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><p>Redis的设计充分考虑了高性能和高并发需求，结合内存存储、事件驱动模型、优化的数据结构及高效的通信协议，使其成为现代高性能应用程序的理想选择。同时，开发者在使用时也需注意数据持久化和内存管理，以确保数据的安全性和持久性。</p>
<h2 id="Redis-除了做缓存，还能做什么？"><a href="#Redis-除了做缓存，还能做什么？" class="headerlink" title="Redis 除了做缓存，还能做什么？"></a>Redis 除了做缓存，还能做什么？</h2><ul>
<li><strong>分布式锁</strong>：通过 Redis 来做分布式锁是一种比较常见的方式。通常情况下，我们都是基于 Redisson 来实现分布式锁。关于 Redis 实现分布式锁的详细介绍，可以看我写的这篇文章：<a target="_blank" rel="noopener" href="https://javaguide.cn/distributed-system/distributed-lock.html">分布式锁详解</a> 。</li>
<li><strong>限流</strong>：一般是通过 Redis + Lua 脚本的方式来实现限流。如果不想自己写 Lua 脚本的话，也可以直接利用 Redisson 中的 <code>RRateLimiter</code> 来实现分布式限流，其底层实现就是基于 Lua 代码+令牌桶算法。</li>
<li><strong>消息队列</strong>：Redis 自带的 List 数据结构可以作为一个简单的队列使用。Redis 5.0 中增加的 Stream 类型的数据结构更加适合用来做消息队列。它比较类似于 Kafka，有主题和消费组的概念，支持消息持久化以及 ACK 机制。</li>
<li><strong>延时队列</strong>：Redisson 内置了延时队列（基于 Sorted Set 实现的）。</li>
<li><strong>分布式 Session</strong> ：利用 String 或者 Hash 数据类型保存 Session 数据，所有的服务器都可以访问。</li>
<li><strong>复杂业务场景</strong>：通过 Redis 以及 Redis 扩展（比如 Redisson）提供的数据结构，我们可以很方便地完成很多复杂的业务场景比如通过 Bitmap 统计活跃用户、通过 Sorted Set 维护排行榜。</li>
</ul>
<h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><p>Redis支持事务，即在一次请求中执行多个命令。步骤如下。</p>
<ul>
<li><strong>MULTI</strong>开启一个事务，将多个命令放入一个队列，入队到事务中，最后由 <strong>EXEC</strong> 命令触发事务， 一并执行事务中的所有命令。（<strong>DISCARD</strong>取消事务）</li>
</ul>
<p><strong>关系型数据库的事务一般是原子性操作</strong>（要么全部成功，要么全部失败）</p>
<p><strong>单个 Redis 命令的执行是原子性的</strong>，但 Redis 没有在事务上增加任何维持原子性的机制，所以 <strong>Redis 事务的执行并不是原子性的</strong>。</p>
<p>Redis不能保证事务中 的命令全部执行成功，但是可以提供一下<strong>三个重要的保证</strong>：</p>
<ul>
<li><strong>批量操作在发送 EXEC 命令前被放入队列缓存。</strong></li>
<li><strong>收到 EXEC 命令后进入事务执行，事务中任意命令执行失败，其余的命令依然被执行。</strong></li>
<li><strong>在事务执行过程，其他客户端提交的命令请求不会插入到事务执行命令序列中。</strong></li>
</ul>
<p>一个事务从开始到执行会经历以下<strong>三个阶段</strong>：</p>
<ul>
<li>开始事务。</li>
<li>命令入队。</li>
<li>执行事务。</li>
</ul>
<h2 id="Redis-线程模型（重要）"><a href="#Redis-线程模型（重要）" class="headerlink" title="Redis 线程模型（重要）"></a>Redis 线程模型（重要）</h2><p>对于读写命令来说，Redis 一直是单线程模型。不过，在 Redis 4.0 版本之后引入了多线程来执行一些大键值对的异步删除操作， Redis 6.0 版本之后引入了多线程来处理网络请求（提高网络 IO 读写性能）。</p>
<h3 id="Redis-单线程模型了解吗？"><a href="#Redis-单线程模型了解吗？" class="headerlink" title="Redis 单线程模型了解吗？"></a>Redis 单线程模型了解吗？</h3><hr>
<h2 id="持久化"><a href="#持久化" class="headerlink" title="持久化"></a>持久化</h2><p>redis的数据全部在<strong>内存</strong>中，如果突然宕机，数据就会全部丢失，未保证redis的数据在发生突发状况时不会丢失、或者只丢失少量，必须根据一些策略来把redis内存中的数据写到<strong>磁盘</strong>中，这样当redis服务重启时，就会将硬盘中的数据恢复到内存中。<strong>Redis持久化的意义就是为了保证突然宕机，内存数据不会全部丢失。</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/10/14/8OuGJWKSjizsQ6o.jpg" alt="img"></p>
<p>详细：<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000039208726">Redis专题：万字长文详解持久化原理 - 码路印记 - SegmentFault 思否</a></p>
<h2 id="主从复制"><a href="#主从复制" class="headerlink" title="主从复制"></a>主从复制</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>主从复制，是指将一台Redis服务器的数据，复制到其他的redis服务器。前者称为主节点(master&#x2F;leader)，后者称为从节点(slave&#x2F;follower) 。<strong>数据的复制是单向的，只能从主节点复制到父节点</strong>。<strong>Master以写为主，Slave以读为主。</strong></p>
<p><strong>默认情况下，每台redis服务器都是主节点</strong>，且一个主节点能有多个从节点，但一个从节点只能有一个主节点。</p>
<h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><ol>
<li><strong>读写分离</strong>：主节点写，从节点读，提高服务器的读写负载能力</li>
<li><strong>数据冗余</strong>：主从复制实现了数据的热备份，是持久化之外的一种数据冗余方式。</li>
<li><strong>故障恢复</strong>：当主节点出现问题时，可以由从节点提供服务，实现快速的故障恢复 ; 实际上是一种服务的冗余。</li>
<li><strong>负载均衡</strong>：在主从复制的基础上，配合读写分离，可以由主节点提供写服务，由从节点提供读服务（即写Redis数据时应用连接主节点，读Redis数据时应用连接从节点），分担服务器负载 ; 尤其是在写少读多的场景下，通过多个从节点分担读负载，可以大大提高Redis服务器的并发量。</li>
<li><strong>高可用（集群）基石</strong>：除了上述作用以外，主从复制还是哨兵和集群能够实施的基础，因此说主从复制是Redis高可用的基础。</li>
</ol>
<p>详情： <a target="_blank" rel="noopener" href="https://blog.csdn.net/Cantevenl/article/details/115839649">Redis——Redis主从复制（工作流程详解）_redis主从复制过程-CSDN博客</a></p>
<h2 id="哨兵模式"><a href="#哨兵模式" class="headerlink" title="哨兵模式"></a>哨兵模式</h2><p>哨兵是一个<strong>分布式系统</strong>，你可以在一个架构中运行多个哨兵进程，这些进程使用流言协议来接收关于Master主服务器是否下线的信息，并使用投票协议来决定是否执行自动故障迁移，以及选择哪个Slave作为新的Master。</p>
<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><h4 id="1-1、为什么要启动哨兵模式"><a href="#1-1、为什么要启动哨兵模式" class="headerlink" title="1.1、为什么要启动哨兵模式"></a>1.1、为什么要启动哨兵模式</h4><p>当我们的redis主服务器宕机后，手动切换主从模式的这种人工干预，费事费力，并且会造成我们的服务一段时间不可用。所以我们通过哨兵模式来解决这个问题。</p>
<h4 id="1-2、什么是哨兵模式"><a href="#1-2、什么是哨兵模式" class="headerlink" title="1.2、什么是哨兵模式"></a>1.2、什么是哨兵模式</h4><p>哨兵模式是对redis系统运行情况的监控，它是一个独立的进程，功能有二个：</p>
<ul>
<li>监控主机redis和从机redis是否正常运行</li>
<li>主机故障后主动将从机转换为主机</li>
</ul>
<h4 id="1-3、哨兵工作原理"><a href="#1-3、哨兵工作原理" class="headerlink" title="1.3、哨兵工作原理"></a>1.3、哨兵工作原理</h4><p><strong>单个哨兵的工作原理：</strong></p>
<p>单个哨兵，只需要监控主Redis，就可能得到从Redis。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/10/14/idOu7QeSGmHc9xD.png" alt="img"></p>
<p><strong>多个哨兵的工作原理：</strong></p>
<p>多个哨兵，不仅同时监控主从Redis，而且哨兵之间互为监控。</p>
<p>多个哨兵，<strong>防止哨兵单点故障。</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/10/14/EHlCBYxoOm1aDzT.png" alt="img"></p>
<h4 id="1-4、哨兵功能"><a href="#1-4、哨兵功能" class="headerlink" title="1.4、哨兵功能"></a>1.4、哨兵功能</h4><p><strong>集群监控：</strong>负责监控主从集群中的Master和Slave进程是否正常工作。</p>
<p><strong>故障转移(failover)：</strong>如果Master宕机，会自动从Slave中选举出新的Master，进行主从自动切换。</p>
<p><strong>配置中心：</strong>如果发生了故障转移，Sentinel负责通知客户端新的Master的地址。</p>
<p><strong>消息通知：</strong>如果某个redis节点有故障，那么Sentsinel会发送报警消息给系统管理员。</p>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><h3 id="服务器相关命令"><a href="#服务器相关命令" class="headerlink" title="服务器相关命令"></a>服务器相关命令</h3><ul>
<li>ping ： 检测连接是否存活</li>
<li>echo： 在命令行打印一些内容</li>
<li>quit、exit： 退出客户端</li>
<li>shutdown： 退出服务器端</li>
<li>info： 返回redis相关信息</li>
<li>config get dir&#x2F;* 实时传递接收的请求</li>
<li>showlog： 显示慢查询</li>
<li>select n： 切换到数据库n，redis默认有16个数据库（DB 0~DB 15），默认使用的第0个</li>
<li>dbsize： 查看当前数据库大小</li>
<li>move key n： 不同数据库之间数据是不能互通的，move移动键到指定数据库</li>
<li>flushdb： 清空当前数据库中的键值对。</li>
<li>flushall： 清空所有数据库的键值对。</li>
</ul>
<h3 id="key相关命令"><a href="#key相关命令" class="headerlink" title="key相关命令"></a>key相关命令</h3><p><strong>在redis中无论什么数据类型，在数据库中都是以key-value形式保存，通过进行对Redis-key的操作，来完成对数据库中数据的操作。</strong></p>
<h4 id="常用命令："><a href="#常用命令：" class="headerlink" title="常用命令："></a>常用命令：</h4><ul>
<li>keys * ：查看当前数据库中所有的key</li>
<li>dbsize： 键总数</li>
<li>exists key： 检查键是否存在</li>
<li>del key [key …]： 删除键</li>
<li>expire key seconds： 键过期</li>
<li>ttl key： 获取键的有效时长</li>
<li>persist key： 移除键的过期时间</li>
<li>type key： 键的数据结构类型</li>
<li>randomkey： 随机返回数据库中一个键</li>
<li>rename key1 key2 ： 重命名</li>
<li>renamex key1 key2 ： 当key2不存在时，key1重命名</li>
</ul>
<p><strong>代码示例：</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/10/14/P6R9yEHs7SkXlWG.png" alt="img"></p>
<h3 id="五大数据类型"><a href="#五大数据类型" class="headerlink" title="五大数据类型"></a>五大数据类型</h3><p>Redis是一个开源（BSD许可），内存存储的数据结构服务器，可用作数据库，高速缓存和消息队列代理。其通过提供多种键值数据类型来适应不同场景下的存储需求，目前为止Redis支持的键值数据类型如下：</p>
<ul>
<li>字符串类型： string</li>
<li>哈希类型： hash</li>
<li>列表类型： list</li>
<li>集合类型： set</li>
<li>有序集合类型： sortedset（zset）</li>
</ul>
<h3 id="String-字符串"><a href="#String-字符串" class="headerlink" title="String(字符串)"></a>String(字符串)</h3><p>字符串类型是Redis最基础的数据结构，其它的几种数据结构都是在字符串类型基础上构建的，字符串的值可以是：字符串、数字、二进制，但其值最大不能超过512M。</p>
<p><strong>使用场景</strong>： 缓存、计数器、对象存储缓存（共享session）、限速</p>
<p><strong>常用命令：</strong></p>
<ul>
<li>set key value： 设置一个key的value值</li>
<li>setnx key value： 仅当key不存在时进行set</li>
<li>setex key seconds value： set 键值对并设置过期时间</li>
<li>mset key value [key value …]： 设置多个key value</li>
<li>msetnx key1 value1 [key2 value2…]： 批量设置键值对，仅当参数中所有的key都不存在时执行，原子性操作，一起成功，一起失败</li>
<li>get key： 返回key的value</li>
<li>mget key [key …] ： 批量获取多个key保存的值</li>
<li>exists key [key …]： 查询一个key是否存在</li>
<li>decr&#x2F;incr key： 将指定key的value数值进行+1&#x2F;-1(仅对于数字)</li>
<li>incrby&#x2F;decrbyB key n： 按指定的步长对数值进行加减</li>
<li>incrbyfloat key n： 为数值加上浮点型数值</li>
<li>append key value： 向指定的key的value后追加字符串</li>
<li>strlen key： 返回key的string类型value的长度。</li>
<li>getset key value： 设置一个key的value，并获取设置前的值，如果不存在则返回null</li>
<li>setrange key offset value： 设置指定位置的字符</li>
<li>getrange key start end： 获取存储在key上的值的一个子字符串</li>
</ul>
<p><strong>代码示例：</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/10/14/YQcgSBbqtAX1awH.png" alt="img"></p>
<h3 id="List-列表"><a href="#List-列表" class="headerlink" title="List(列表)"></a>List(列表)</h3><p>Redis列表是简单的字符串列表，按照插入顺序排序。你可以添加一个元素到列表的头部（左边）或者尾部（右边），也可以获取指定范围指定下标的元素等。一个列表最多可以包含 232 - 1 个元素 (4294967295, 每个列表超过40亿个元素)。</p>
<p><strong>两个特点：</strong></p>
<p>1.列表中的元素是有序的，可以通过索引下标获取某个元素霍某个某个范围内的元素列表</p>
<p>2.列表中的元素可以是重复的</p>
<p><strong>使用场景：</strong> 消息队列、栈、文章列表等。</p>
<p><strong>常用指令：</strong></p>
<ul>
<li><strong>添加操作</strong></li>
<li>lpush&#x2F;rpush key value1[value2…]： 从左边&#x2F;右边向列表中PUSH值(一个或者多个)</li>
<li>lpushx&#x2F;rpushx key value： 向已存在的列名中push值（一个或者多个），list不存在 lpushx失败</li>
<li>linsert key before|after pivot value： 在指定列表元素的前&#x2F;后 插入value</li>
<li><strong>查找操作</strong></li>
<li>lindex key index： 通过索引获取列表元素</li>
<li>lrange key start end： 获取list 起止元素 （索引从左往右 递增）</li>
<li>llen key： 查看列表长度</li>
<li><strong>删除操作</strong></li>
<li>lpop&#x2F;rpop key： 从最左边&#x2F;最右边移除值 并返回</li>
<li>lrem key count value： count &gt;0：从头部开始搜索 然后删除指定的value 至多删除count个 count &lt; 0：从尾部开始搜索… count &#x3D; 0：删除列表中所有的指定value。</li>
<li>ltrim key start end： 通过下标截取指定范围内的列表</li>
<li>rpoplpush source destination： 将列表的尾部(右)最后一个值弹出，并返回，然后加到另一个列表的头部</li>
<li><strong>修改操作</strong></li>
<li>lset key index value： 通过索引为元素设值</li>
<li><strong>阻塞操作</strong></li>
<li>blpop&#x2F;brpop key1[key2] timout： 移出并获取列表的第一个&#x2F;最后一个元素，如果列表没有元素会阻塞列表直到等待超时或发现可弹出元素为止。</li>
<li>brpoplpush source destination timeout： 和rpoplpush功能相同，如果列表没有元素会阻塞列表直到等待超时或发现可弹出元素为止。</li>
</ul>
<p><strong>代码示例：</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/10/14/CU7pgFtohu3ajBz.png" alt="img"></p>
<h3 id="Set-集合）"><a href="#Set-集合）" class="headerlink" title="Set(集合）"></a>Set(集合）</h3><p>Redis的Set是string类型的无序集合，我们不能通过索引获取元素。集合成员是唯一的，这就意味着集合中不能出现重复的数据。Redis中集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。集合中最大的成员数为 232 - 1 (4294967295, 每个集合可存储40多亿个成员)。</p>
<p><strong>应用场景：</strong> 标签（tag）</p>
<p><strong>常用命令：</strong></p>
<ul>
<li><strong>集合内操作</strong></li>
<li>sadd key member1[member2…]： 向集合中无序增加一个&#x2F;多个成员</li>
<li>srem key member1[member2…]： 移除集合中一个&#x2F;多个成员</li>
<li>scard key： 获取集合的成员数</li>
<li>smembers key： 返回集合中所有的成员</li>
<li>sismember key member： 查询member元素是否是集合的成员，若存在返回1，不存在返回0</li>
<li>srandmember key [count]： 随机返回集合中count个成员，count缺省值为1</li>
<li>spop key [count]： 随机移除并返回集合中count个成员，count缺省值为1</li>
<li><strong>集合间操作</strong></li>
<li>sinter key1 [key2…]： 返回所有集合的交集</li>
<li>sinterstore destination key1[key2…]： 在SINTER的基础上，存储结果到集合中。覆盖</li>
<li>sunion key1 [key2…]： 返回所有集合的并集</li>
<li>sunionstore destination key1 [key2…]： 在SUNION的基础上，存储结果到及和张。覆盖</li>
<li>sdiff key1[key2…]： 返回所有集合的差集 key1- key2 - …</li>
<li>sdiffstore destination key1[key2…]： 在SDIFF的基础上，将结果保存到集合中。覆盖</li>
<li>smove source destination member： 将source集合的成员member移动到destination集合</li>
<li>sscan key [MATCH pattern] [COUNT count]： 在大量数据环境下，使用此命令遍历集合中元素，每次遍历部分</li>
</ul>
<p><strong>代码示例：</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/10/14/E3LCvbWmGPoNSJq.png" alt="img"></p>
<h3 id="Hash（哈希）"><a href="#Hash（哈希）" class="headerlink" title="Hash（哈希）"></a>Hash（哈希）</h3><p>几乎所有的编程语言都提供了哈希（hash）结构，Redis中 hash 是一个string类型的field和value的映射表value&#x3D;</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/xi.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/xi.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">池慕睡不着</div><div class="post-copyright__author_desc">生活明朗，万物可爱</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2024/07/09/Redis/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2024/07/09/Redis/')">Redis</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2024/07/09/Redis/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=Redis&amp;url=http://example.com/2024/07/09/Redis/&amp;pic=https://s2.loli.net/2024/10/14/DhY7V3iNnEbfuSL.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">池慕睡不着</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"></div></div></div><div class="post_share"><div class="social-share" data-image="/img/default_cover.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/05/08/%E4%BD%BF%E7%94%A8docker%E5%B8%B8%E8%A7%81%E7%9A%84%E9%97%AE%E9%A2%98/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/05/08/utTWAyzeVdRJsMw.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">使用docker常见的问题</div></div></a></div><div class="next-post pull-right"><a href="/2024/09/30/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/05/06/qBRrYEckmoTXuz7.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">设计模式</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/xi.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description">生活明朗，万物可爱</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">池慕睡不着</h1><div class="author-info__desc">生活明朗，万物可爱</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/CH-EN-X" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/131461665" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%BF%99%E4%B9%88%E5%BF%AB%EF%BC%9F"><span class="toc-number">1.1.</span> <span class="toc-text">Redis 为什么这么快？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Redis-%E5%9F%BA%E4%BA%8E%E5%86%85%E5%AD%98"><span class="toc-number">1.1.1.</span> <span class="toc-text">1. Redis 基于内存</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%9F%BA%E4%BA%8EReactor%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.1.2.</span> <span class="toc-text">2. 基于Reactor模式的事件处理模型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%A4%9A%E7%A7%8D%E4%BC%98%E5%8C%96%E8%BF%87%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.3.</span> <span class="toc-text">3. 多种优化过后的数据类型&#x2F;结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E7%AE%80%E5%8D%95%E4%B8%94%E9%AB%98%E6%95%88%E7%9A%84%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.1.4.</span> <span class="toc-text">4. 简单且高效的通信协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">1.1.5.</span> <span class="toc-text">小结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Redis-%E9%99%A4%E4%BA%86%E5%81%9A%E7%BC%93%E5%AD%98%EF%BC%8C%E8%BF%98%E8%83%BD%E5%81%9A%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">2.</span> <span class="toc-text">Redis 除了做缓存，还能做什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1"><span class="toc-number">3.</span> <span class="toc-text">事务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Redis-%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%EF%BC%88%E9%87%8D%E8%A6%81%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">Redis 线程模型（重要）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis-%E5%8D%95%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E4%BA%86%E8%A7%A3%E5%90%97%EF%BC%9F"><span class="toc-number">4.1.</span> <span class="toc-text">Redis 单线程模型了解吗？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">5.</span> <span class="toc-text">持久化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="toc-number">6.</span> <span class="toc-text">主从复制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-number">6.1.</span> <span class="toc-text">概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8"><span class="toc-number">6.2.</span> <span class="toc-text">作用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F"><span class="toc-number">7.</span> <span class="toc-text">哨兵模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">7.1.</span> <span class="toc-text">概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%90%AF%E5%8A%A8%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F"><span class="toc-number">7.1.1.</span> <span class="toc-text">1.1、为什么要启动哨兵模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F"><span class="toc-number">7.1.2.</span> <span class="toc-text">1.2、什么是哨兵模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3%E3%80%81%E5%93%A8%E5%85%B5%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">7.1.3.</span> <span class="toc-text">1.3、哨兵工作原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4%E3%80%81%E5%93%A8%E5%85%B5%E5%8A%9F%E8%83%BD"><span class="toc-number">7.1.4.</span> <span class="toc-text">1.4、哨兵功能</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">8.</span> <span class="toc-text">常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-number">8.1.</span> <span class="toc-text">服务器相关命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#key%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-number">8.2.</span> <span class="toc-text">key相关命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%EF%BC%9A"><span class="toc-number">8.2.1.</span> <span class="toc-text">常用命令：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">8.3.</span> <span class="toc-text">五大数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#String-%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">8.4.</span> <span class="toc-text">String(字符串)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#List-%E5%88%97%E8%A1%A8"><span class="toc-number">8.5.</span> <span class="toc-text">List(列表)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Set-%E9%9B%86%E5%90%88%EF%BC%89"><span class="toc-number">8.6.</span> <span class="toc-text">Set(集合）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hash%EF%BC%88%E5%93%88%E5%B8%8C%EF%BC%89"><span class="toc-number">8.7.</span> <span class="toc-text">Hash（哈希）</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/04/08/RAG/" title="RAG"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RAG"/></a><div class="content"><a class="title" href="/2025/04/08/RAG/" title="RAG">RAG</a><time datetime="2025-04-08T07:23:48.000Z" title="发表于 2025-04-08 15:23:48">2025-04-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/13/RabbitMQ/" title="RabbitMQ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RabbitMQ"/></a><div class="content"><a class="title" href="/2024/10/13/RabbitMQ/" title="RabbitMQ">RabbitMQ</a><time datetime="2024-10-13T15:10:16.000Z" title="发表于 2024-10-13 23:10:16">2024-10-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/13/Kafka/" title="Kafka"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/10/16/pVI3ud5PiaUyzM1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kafka"/></a><div class="content"><a class="title" href="/2024/10/13/Kafka/" title="Kafka">Kafka</a><time datetime="2024-10-13T15:09:59.000Z" title="发表于 2024-10-13 23:09:59">2024-10-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/13/JVM/" title="JVM"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/10/21/iCFLdcEoHvSwfM4.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JVM"/></a><div class="content"><a class="title" href="/2024/10/13/JVM/" title="JVM">JVM</a><time datetime="2024-10-13T15:09:41.000Z" title="发表于 2024-10-13 23:09:41">2024-10-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/07/DDD/" title="DDD"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/default_cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DDD"/></a><div class="content"><a class="title" href="/2024/10/07/DDD/" title="DDD">DDD</a><time datetime="2024-10-07T14:21:35.000Z" title="发表于 2024-10-07 22:21:35">2024-10-07</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="/1211931367@qq.com" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/xi.jpg" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/CH-EN-X" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/131461665" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">服务</div><div class="footer-links"><a class="footer-item" title="51la统计" target="_blank" rel="noopener" href="https://v6.51.la/">51la统计</a><a class="footer-item" title="十年之约" target="_blank" rel="noopener" href="https://www.foreverblog.cn/">十年之约</a><a class="footer-item" title="开往" target="_blank" rel="noopener" href="https://github.com/travellings-link/travellings">开往</a></div></div><div class="footer-group"><div class="footer-title">主题</div><div class="footer-links"><a class="footer-item" title="文档" href="/docs/">文档</a><a class="footer-item" title="源码" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu">源码</a><a class="footer-item" title="更新日志" href="/update/">更新日志</a></div></div><div class="footer-group"><div class="footer-title">导航</div><div class="footer-links"><a class="footer-item" title="即刻短文" href="/essay/">即刻短文</a><a class="footer-item" title="友链文章" href="/fcircle/">友链文章</a><a class="footer-item" title="留言板" href="/comments/">留言板</a></div></div><div class="footer-group"><div class="footer-title">协议</div><div class="footer-links"><a class="footer-item" title="隐私协议" href="/privacy/">隐私协议</a><a class="footer-item" title="Cookies" href="/cookies/">Cookies</a><a class="footer-item" title="版权协议" href="/copyright/">版权协议</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">友链</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="换一批友情链接"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2025 By <a class="footer-bar-link" href="/" title="池慕睡不着" target="_blank">池慕睡不着</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      if (true) {
        const from = '出自 ' + data.from
        const sub = []
        sub.unshift(data.hitokoto, from)
        window.typed = new Typed('#footer-type-tips', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('footer-type-tips').innerHTML = data.hitokoto
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.cbd.int/typed.js@2.0.15/dist/typed.umd.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">0</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://ch-en-x.github.io" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" href="/null" title="图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="图床"/><span class="back-menu-item-text">图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/HTTP/" style="font-size: 0.88rem;">HTTP<sup>1</sup></a><a href="/tags/Java%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/" style="font-size: 0.88rem;">Java开发规范<sup>1</sup></a><a href="/tags/MySQL/" style="font-size: 0.88rem;">MySQL<sup>2</sup></a><a href="/tags/Spring/" style="font-size: 0.88rem;">Spring<sup>5</sup></a><a href="/tags/docker/" style="font-size: 0.88rem;">docker<sup>2</sup></a><a href="/tags/java%E5%9F%BA%E7%A1%80/" style="font-size: 0.88rem;">java基础<sup>1</sup></a><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 0.88rem;">设计模式<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.4/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("06/01/2023 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.10",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 池慕睡不着 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "visitor@anheyu.com";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>